#!/bin/sh
set -eu

echo Hi!
echo $ENEXA_META_DATA_ENDPOINT
echo "test 20230808"
#echo 'select ?s ?p ?o {?s ?p ?o.}' |sparql-select "$ENEXA_META_DATA_ENDPOINT"

    
PREFIX=http://w3id.org/dice-research/enexa/module/dice-embeddings/

echo ./main.py \
    --save_embeddings_as_csv  \
    --path_dataset_folder="$(enexa-parameter "${PREFIX}parameter/path_dataset_folder")" \
    --model="$(enexa-parameter "${PREFIX}parameter/model")" \
    --num_epochs="$(enexa-parameter "${PREFIX}parameter/num_epochs")" \
    --embedding_dim="$(enexa-parameter "${PREFIX}parameter/embedding_dim")" \

./main.py \
    --save_embeddings_as_csv  \
    --path_dataset_folder="$(enexa-parameter "${PREFIX}parameter/path_dataset_folder")" \
    --model="$(enexa-parameter "${PREFIX}parameter/model")" \
    --num_epochs="$(enexa-parameter "${PREFIX}parameter/num_epochs")" \
    --embedding_dim="$(enexa-parameter "${PREFIX}parameter/embedding_dim")" \
    --absolute_path_to_store="$ENEXA_MODULE_INSTANCE_DIRECTORY"

enexa-add-file "$ENEXA_MODULE_INSTANCE_DIRECTORY"/configuration.json
enexa-add-file "$ENEXA_MODULE_INSTANCE_DIRECTORY"/epoch_losses.csv
enexa-add-file "$ENEXA_MODULE_INSTANCE_DIRECTORY"/eval_report.json
enexa-add-file "$ENEXA_MODULE_INSTANCE_DIRECTORY"/model.pt "${PREFIX}parameter/model.pt"
enexa-add-file "$ENEXA_MODULE_INSTANCE_DIRECTORY"/report.json
enexa-add-file "$ENEXA_MODULE_INSTANCE_DIRECTORY"/*_entity_embeddings.csv "${PREFIX}parameter/entity_embeddings.csv"
